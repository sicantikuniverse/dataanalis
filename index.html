<div id="status"></div>

<script>
  document.getElementById('uploadBtn').addEventListener('click', async () => {
    const fileInput = document.getElementById('excelFile');
    if (!fileInput.files.length) {
      alert('Pilih file Excel dulu!');
      return;
    }

    const file = fileInput.files[0];
    const formData = new FormData();
    formData.append('file', file);

    const statusDiv = document.getElementById('status');
    statusDiv.textContent = 'Uploading...';

    try {
      const res = await fetch('/api/importExcel', {
        method: 'POST',
        body: formData
      });

      const result = await res.json();
      statusDiv.textContent = result.message;  // ‚Üê pesan sukses / error dari server
    } catch (err) {
      statusDiv.textContent = 'Error: ' + err.message;
    }
  });
</script>
