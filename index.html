<h2>Test Upload Excel - 1 Baris</h2>
<input type="file" id="excelFile" />
<button id="uploadBtn">Upload</button>
<pre id="status"></pre>

<script>
document.getElementById('uploadBtn').addEventListener('click', async () => {
  const fileInput = document.getElementById('excelFile');
  if (!fileInput.files.length) {
    alert('Pilih file Excel dulu!');
    return;
  }

  const file = fileInput.files[0];
  const formData = new FormData();
  formData.append('file', file);

  const statusDiv = document.getElementById('status');
  statusDiv.textContent = 'Uploading...';

  try {
    const res = await fetch('/api/testDb', { method: 'POST', body: formData });
    const text = await res.text();

    let result;
    try {
      result = JSON.parse(text);
    } catch (e) {
      statusDiv.textContent = 'Response bukan JSON:\n' + text;
      return;
    }

    statusDiv.textContent = JSON.stringify(result, null, 2);

  } catch (err) {
    statusDiv.textContent = 'Fetch error: ' + err.message;
  }
});
</script>
