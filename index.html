<h2>Import Excel ke Database Penjualan</h2>
<input type="file" id="excelFile" />
<button id="uploadBtn">Upload</button>
<div id="status"></div>

<script>
  document.getElementById('uploadBtn').addEventListener('click', async () => {
    const fileInput = document.getElementById('excelFile');
    if (!fileInput.files.length) {
      alert('Pilih file Excel dulu!');
      return;
    }

    const file = fileInput.files[0];
    const formData = new FormData();
    formData.append('file', file);

    const statusDiv = document.getElementById('status');
    statusDiv.textContent = 'Uploading...';

    try {
      const res = await fetch('/api/importExcel', {
        method: 'POST',
        body: formData
      });

      const result = await res.json();

      let text = result.message;
      if (result.failedRows && result.failedRows.length > 0) {
        text += '\nBaris gagal:\n';
        result.failedRows.forEach(f => {
          text += `Baris ${f.rowNumber}: ${f.error}\n`;
        });
      }

      statusDiv.textContent = text;
    } catch (err) {
      statusDiv.textContent = 'Error: ' + err.message;
    }
  });
</script>
